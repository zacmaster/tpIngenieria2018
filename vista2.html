<div id="contenedor-mapa-depositos">
    <div id="ajax-spinner"><img src="resources/img/spinner_large.gif" alt=""></div>
</div>

<script>
    var depositos = [];
    var callbackDepositos = function (response) {
        console.log('Mostrando depÃ³sitos');
        var cache = response;
        $(document).ready(function (){
            cache.depositos.forEach(element => {
                depositos.push(element);
            });
            dibujarDepositos();
        });
        // console.log(response);
    }

    function dibujarDepositos(){
        depositos.forEach(element => {
            console.log(element);
        });
        var a = depositos[1].ubicacion.lat;
        var b = depositos[1].ubicacion.lon;
        mymap.setView([a,b],15);
    }
    $(document).ready(function(){
        asyncQuery('https://infraccionesya.herokuapp.com/api/depositos',  callbackDepositos);
    });
    $('#ajax-spinner').hide();
    $(document)
    .ajaxStart(function(){
        $('#ajax-spinner').show();
    })
    .ajaxStop(function(){
        $('#ajax-spinner').hide();
    });



    var mymap = L.map('contenedor-mapa-depositos').setView([51.505, -0.09], 13);

    L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png', {
    attribution: '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'
    }).addTo(mymap);

     // Agregamos el control para seleccionar Layers al mapa
    var layersControl = L.control.layers({
      "Base": baseLayer
    });
</script>